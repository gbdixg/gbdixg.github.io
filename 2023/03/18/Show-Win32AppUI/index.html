<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Create Intune Win32Apps with a PowerShell GUI front-end | Write-Verbose</title><meta name=keywords content="Intune,MSGraph,WPF"><meta name=description content="A PowerShell GUI app to simplify creating Win32 Apps in Intune"><meta name=author content="GD"><link rel=canonical href=https://write-verbose.com/2023/03/18/Show-Win32AppUI/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://write-verbose.com/fav/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://write-verbose.com/fav/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://write-verbose.com/fav/favicon-32x32.png><link rel=apple-touch-icon href=https://write-verbose.com/apple-touch-icon.png><link rel=mask-icon href=https://write-verbose.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-141237050-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Create Intune Win32Apps with a PowerShell GUI front-end"><meta property="og:description" content="A PowerShell GUI app to simplify creating Win32 Apps in Intune"><meta property="og:type" content="article"><meta property="og:url" content="https://write-verbose.com/2023/03/18/Show-Win32AppUI/"><meta property="og:image" content="https://write-verbose.com/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-18T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://write-verbose.com/papermod-cover.png"><meta name=twitter:title content="Create Intune Win32Apps with a PowerShell GUI front-end"><meta name=twitter:description content="A PowerShell GUI app to simplify creating Win32 Apps in Intune"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://write-verbose.com/posts/"},{"@type":"ListItem","position":2,"name":"Create Intune Win32Apps with a PowerShell GUI front-end","item":"https://write-verbose.com/2023/03/18/Show-Win32AppUI/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Create Intune Win32Apps with a PowerShell GUI front-end","name":"Create Intune Win32Apps with a PowerShell GUI front-end","description":"A PowerShell GUI app to simplify creating Win32 Apps in Intune","keywords":["Intune","MSGraph","WPF"],"articleBody":"A GUI tool for end-to-end creation of Win32 Apps in Microsoft Intune.\nThis post provides details of “Show-Win32AppUI”, a GUI tool that simplifies the end-to-end process of creating Win32 Apps in Intune.\nThe GitHub source is available here. Instructions for setup and use are below.\nThis isn’t a one size fits all community tool. You will likely need to modify it to meet your needs. However, its written in PowerShell and has code comments and blog posts to make editing simpler.\nSETUP Modules Show-Win32AppUI depends on two PowerShell modules. Install these modules if you don’t already have them.\nInstall-Module -Name MSAL.PS Install-Module -Name IntuneWin32App The most recent tested versions are listed below:\nInstall-Module -Name MSAL.PS -RequiredVersion 4.37.0.0 Install-Module -Name IntuneWin32App -RequiredVersion 1.4.0 Tenant ID Update the $TenantID on line 4 of Show-Win32AppUI.ps1 to use your required Azure tenant. Your tenant ID is available from the Azure AD portal Overview page.\nAzure Client App An Azure Client App is used with interactive authentication to access the Microsoft Graph. There are two setup steps required:\nSpecify the Azure application\nBy default, the tool will use the built-in Microsoft Graph PowerShell enterprise application. However, I recommend creating a custom Azure app in your own tenant. A step by step guide to creating a custom app is available here. If using a custom app, update Show-Win32AppUI.ps1 to set the $ClientID variable on line 6 to match the client ID (a.k.a Application ID) of your app.\nConsent to the required permissions on behalf of your tenant\nWhether you use a custom app or Microsoft Graph PowerShell, the app must be configured with the required API permissions and consent must be granted. The delegated permissions are listed below. A step by step for setting these permissions can be found in the second part of this article. Directory.AccessAsUser.All DeviceManagementApps.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All User.Read User permissions Delegated consent uses the intersection of application permissions and user permissions to authorise access. i.e. the authenticated user must have the required permissions as well as the application. When using the app, authenticate using an Azure account with one of the following roles:\nIntune Administrator Global Administrator Workstation permissions The tool does not need administrative access to the client workstation. Internet access is required, to download the Win32 Content Prep tool on first use.\nPowerShell script execution PowerShell script execution is disabled on Windows clients by default. Use one of the methods below to allow script execution on the workstation.\nset-executionpolicy Unrestricted or\npowershell -executionpolicy bypass -file Launch the tool Start a PowerShell 5.1 or Pwsh 7.x console and execute the script as follows:\n.\\Show-Win32AppUI.ps1 To show debug information in the console add the WriteHost switch:\n.\\Show-Win32AppUI.ps1 -WriteHost Using the tool Page1 - Package Use the file dialog to select the main Setup File - .msi, .exe or .ps1.\nFor an .msi file, the setup and uninstall automatically uses MSIEXEC, defaulting to a quiet install/uninstall and verbose logging.\nFor an .exe file, the setup parameters default to /S, but you should check the vendor information and replace this as appropriate.\nFor a .ps1 file, setup and uninstall defaults to -noprofile and -executionpolicy bypass.\nThe package source folder is the folder containing the setup file. All the files in this folder are packaged into an .intunewin file in a later step.\nThe tool creates installation wrapper scripts called install.ps1 and uninstall.ps1 in the package source folder. Existing files with these names are overwritten.\nThe Next button is only available when required fields have been completed. Page2 - Deployment The Display Name is built from the Publisher, App Name, Version and Package Number. If the language is changed from the default or the Bitness is changed to x86, these are also included in the Display Name\nFor .msi and .exe files, the fields are populated with information from the setup file, but can be edited as required.\nIf there is already an Intune application with the same Display Name a warning will appear in the status bar. The simplest solution is to increment the Package Number.\nThe Next button is only available when required fields have been completed. Page3 - Assignment Assignment Groups shows the names of three AAD groups for Required Install, Available Install and Uninstall. The group name suffix is based on the App Name from Page 2 and cannot be edited here.\nThe Owner must be a UPN of an AAD user. Start typing a name in the top box to see a list of options. Select a name and click Add. The Owner is set on the properties of the Win32App and the AAD groups.\nThe Dependency and Supercedence lists are populated with existing Win32 Apps. Select from the list if these options are needed. Currently you can only select one of these options due to a limitation in the IntuneWin32App module.\nClick on the Logo box to select a image file for display with the application in the Company Portal.\nThe Next button is only available when required fields have been completed. Page3 - Implement The final page follows a step-by-step approach to creating the Win32 App.\nCreate Wrapper Scripts creates an install.ps1 and uninstall.ps1 file in the package source folder.\nCreate Intunewin Package uses the Win32 Content Prep Tool to build an .intunewin file in the Output Folder.\nCreate App Groups creates three AAD groups for Required Install, Available Install and Uninstall. If the groups already exist they are re-used.\nCreate Win32 App creates the Win32 App in Intune and uploads the .intunewin file. This step can take some time depending on the package size.\nConfigure Dependency / Configure Supercedence modifies the Win32 App in Intune. These steps are skipped if they are set to None.\nConfigure Assignment modifies the Win32 App in Intune to add the assignment groups created in the earlier step. Troubleshooting The tool creates a debug log on every run with detailed information and error messages. The default LogFolder is C:\\Temp, but can be modified on Line 8 of Show-Win32AppUI.ps1.\nThe -WriteHost switch will also show the debug output in the console.\n.\\Show-Win32AppUI.ps1 -writehost Options The variables section in Show-Win32AppUI.ps1 allows default settings to be modified. The following section is at Line 50:\nDetection Method The Win32 app detection is hardcoded to use a file exists method. The Install.ps1 script wrapper creates a “.ps1.tag” file under the %PROGRAMDATA% folder and Uninstall.ps1 deletes it - a detection method first suggested by Michael Niehaus\nCredits Show-Win32AppUI is a front-end to the excellent IntuneWin32App module. Full credit to the contributors of this project.\nThe MSAL.PS module has simplified the transition from ADAL to MSAL authentication.\nBoe Prox for PowerShell Runspace tips\nSMSAgent for PowerShell WPF tips\nThis article was originally posted on Write-Verbose.com\n","wordCount":"1118","inLanguage":"en","datePublished":"2023-03-18T00:00:00Z","dateModified":"2023-03-18T00:00:00Z","author":{"@type":"Person","name":"GD"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://write-verbose.com/2023/03/18/Show-Win32AppUI/"},"publisher":{"@type":"Organization","name":"Write-Verbose","logo":{"@type":"ImageObject","url":"https://write-verbose.com/fav/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://write-verbose.com/ accesskey=h title="Write-Verbose (Alt + H)">Write-Verbose</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://write-verbose.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://write-verbose.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://write-verbose.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://write-verbose.com/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://write-verbose.com/>Home</a>&nbsp;»&nbsp;<a href=https://write-verbose.com/posts/>Posts</a></div><h1 class=post-title>Create Intune Win32Apps with a PowerShell GUI front-end</h1><div class=post-description>A PowerShell GUI app to simplify creating Win32 Apps in Intune</div><div class=post-meta><span title='2023-03-18 00:00:00 +0000 UTC'>March 18, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;GD</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#setup aria-label=SETUP>SETUP</a><ul><li><a href=#modules aria-label=Modules>Modules</a></li><li><a href=#tenant-id aria-label="Tenant ID">Tenant ID</a></li><li><a href=#azure-client-app aria-label="Azure Client App">Azure Client App</a></li><li><a href=#user-permissions aria-label="User permissions">User permissions</a></li><li><a href=#workstation-permissions aria-label="Workstation permissions">Workstation permissions</a></li><li><a href=#powershell-script-execution aria-label="PowerShell script execution">PowerShell script execution</a></li></ul></li><li><a href=#launch-the-tool aria-label="Launch the tool">Launch the tool</a></li><li><a href=#using-the-tool aria-label="Using the tool">Using the tool</a><ul><ul><li><a href=# aria-label="Page1 - Package">Page1 - Package</a></li><li><a href=# aria-label="Page2 - Deployment">Page2 - Deployment</a></li><li><a href=# aria-label="Page3 - Assignment">Page3 - Assignment</a></li><li><a href=# aria-label="Page3 - Implement">Page3 - Implement</a></li></ul></ul></li><li><a href=#troubleshooting aria-label=Troubleshooting>Troubleshooting</a></li><li><a href=#options aria-label=Options>Options</a></li><li><a href=#detection-method aria-label="Detection Method">Detection Method</a></li><li><a href=#credits aria-label=Credits>Credits</a></li></ul></div></details></div><div class=post-content><p>A GUI tool for end-to-end creation of Win32 Apps in Microsoft Intune.</p><p>This post provides details of &ldquo;Show-Win32AppUI&rdquo;, a GUI tool that simplifies the end-to-end process of creating Win32 Apps in Intune.</p><p>The GitHub source is <a href=https://github.com/gbdixg/Show-Win32AppUI>available here</a>. Instructions for setup and use are below.</p><p><img loading=lazy src=/img/Show-Win32AppUI/Show-Win32AppUI.gif alt=Show-Win32AppUI></p><p>This isn&rsquo;t a one size fits all community tool. You will likely need to modify it to meet your needs. However, its written in PowerShell and has code comments and blog posts to make editing simpler.</p><h1 id=setup>SETUP<a hidden class=anchor aria-hidden=true href=#setup>#</a></h1><h2 id=modules>Modules<a hidden class=anchor aria-hidden=true href=#modules>#</a></h2><p><em>Show-Win32AppUI</em> depends on two PowerShell modules. Install these modules if you don&rsquo;t already have them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>MSAL</span><span class=p>.</span><span class=nb>PS
</span></span></span><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>IntuneWin32App</span>
</span></span></code></pre></div><p>The most recent tested versions are listed below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>MSAL</span><span class=p>.</span><span class=nb>PS </span><span class=n>-RequiredVersion</span> <span class=mf>4.37</span><span class=p>.</span><span class=py>0</span><span class=p>.</span><span class=py>0</span>
</span></span><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>IntuneWin32App</span> <span class=n>-RequiredVersion</span> <span class=mf>1.4</span><span class=p>.</span><span class=py>0</span>
</span></span></code></pre></div><h2 id=tenant-id>Tenant ID<a hidden class=anchor aria-hidden=true href=#tenant-id>#</a></h2><p>Update the $TenantID on line 4 of <em>Show-Win32AppUI.ps1</em> to use your required Azure tenant. Your tenant ID is available from the <a href=https://aad.portal.azure.com/>Azure AD portal</a> <em>Overview</em> page.</p><h2 id=azure-client-app>Azure Client App<a hidden class=anchor aria-hidden=true href=#azure-client-app>#</a></h2><p>An Azure Client App is used with interactive authentication to access the Microsoft Graph. There are two setup steps required:</p><ol><li><strong>Specify the Azure application</strong><br>By default, the tool will use the built-in <em>Microsoft Graph PowerShell</em> enterprise application. However, I recommend creating a custom Azure app in your own tenant. A step by step guide to creating a custom app is available <a href=/2023/03/19/AzureAppRegistration/>here</a>.</li></ol><blockquote><p>If using a custom app, update <em>Show-Win32AppUI.ps1</em> to set the $ClientID variable on line 6 to match the client ID (a.k.a Application ID) of your app.</p></blockquote><ol start=2><li><strong>Consent to the required permissions on behalf of your tenant</strong><br>Whether you use a custom app or Microsoft Graph PowerShell, the app must be configured with the required API permissions and consent must be granted. The <strong>delegated</strong> permissions are listed below. A step by step for setting these permissions can be found in the second part of <a href=/2023/03/19/AzureAppRegistration/>this article</a>.</li></ol><ul><li>Directory.AccessAsUser.All</li><li>DeviceManagementApps.ReadWrite.All</li><li>Group.ReadWrite.All</li><li>GroupMember.ReadWrite.All</li><li>User.Read</li></ul><h2 id=user-permissions>User permissions<a hidden class=anchor aria-hidden=true href=#user-permissions>#</a></h2><p><em>Delegated consent</em> uses the intersection of application permissions and user permissions to authorise access. i.e. the authenticated user must have the required permissions as well as the application. When using the app, authenticate using an Azure account with <em>one</em> of the following roles:</p><ul><li>Intune Administrator</li><li>Global Administrator</li></ul><h2 id=workstation-permissions>Workstation permissions<a hidden class=anchor aria-hidden=true href=#workstation-permissions>#</a></h2><p>The tool does not need administrative access to the client workstation. Internet access is required, to download the <a href=https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool>Win32 Content Prep tool</a> on first use.</p><h2 id=powershell-script-execution>PowerShell script execution<a hidden class=anchor aria-hidden=true href=#powershell-script-execution>#</a></h2><p>PowerShell script execution is disabled on Windows clients by default. Use one of the methods below to allow script execution on the workstation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>set-executionpolicy</span> <span class=n>Unrestricted</span>
</span></span></code></pre></div><p>or</p><pre tabindex=0><code class=language-CMD data-lang=CMD>powershell -executionpolicy bypass -file &lt;path to script&gt;
</code></pre><h1 id=launch-the-tool>Launch the tool<a hidden class=anchor aria-hidden=true href=#launch-the-tool>#</a></h1><p>Start a PowerShell 5.1 or Pwsh 7.x console and execute the script as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=p>.\</span><span class=nb>Show-Win32AppUI</span><span class=p>.</span><span class=py>ps1</span>
</span></span></code></pre></div><p>To show debug information in the console add the <em>WriteHost</em> switch:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=p>.\</span><span class=nb>Show-Win32AppUI</span><span class=p>.</span><span class=py>ps1</span> <span class=n>-WriteHost</span>
</span></span></code></pre></div><h1 id=using-the-tool>Using the tool<a hidden class=anchor aria-hidden=true href=#using-the-tool>#</a></h1><table><tr><td><h3>Page1 - Package</h3>Use the file dialog to select the main <b>Setup File</b> - .msi, .exe or .ps1.<br>For an .msi file, the setup and uninstall automatically uses MSIEXEC, defaulting to a quiet install/uninstall and verbose logging.<br>For an .exe file, the setup parameters default to /S, but you should check the vendor information and replace this as appropriate.<br>For a .ps1 file, setup and uninstall defaults to -noprofile and -executionpolicy bypass.<br><br>The package <b>source folder</b> is the folder containing the setup file. All the files in this folder are packaged into an .intunewin file in a later step.<br><br>The tool creates installation wrapper scripts called install.ps1 and uninstall.ps1 in the package source folder. Existing files with these names are overwritten.<br><br>The <i>Next</i> button is only available when required fields have been completed.</td><td width=450><img src=/img/Show-Win32AppUI/Win32AppUI-Page1.png alt=1 width=450px height=850px></td></tr><tr><td><h3>Page2 - Deployment</h3>The <b>Display Name</b> is built from the Publisher, App Name, Version and Package Number. If the language is changed from the default or the <i>Bitness</i> is changed to x86, these are also included in the Display Name<br><br>For .msi and .exe files, the fields are populated with information from the setup file, but can be edited as required.<br><br>If there is already an Intune application with the same Display Name a warning will appear in the status bar. The simplest solution is to increment the Package Number.<br><br>The <i>Next</i> button is only available when required fields have been completed.</td><td width=450><img src=/img/Show-Win32AppUI/Win32AppUI-Page2.png alt=2 width=450px height=850px></td></tr><tr><td><h3>Page3 - Assignment</h3><b>Assignment Groups</b> shows the names of three AAD groups for <i>Required Install, Available Install and Uninstall</i>. The group name suffix is based on the App Name from Page 2 and cannot be edited here.<br><br>The Owner must be a UPN of an AAD user. Start typing a name in the top box to see a list of options. Select a name and click Add. The Owner is set on the properties of the Win32App and the AAD groups.<br><br>The Dependency and Supercedence lists are populated with existing Win32 Apps. Select from the list if these options are needed. Currently you can only select one of these options due to a limitation in the IntuneWin32App module.<br><br>Click on the Logo box to select a image file for display with the application in the Company Portal.<br><br>The <i>Next</i> button is only available when required fields have been completed.</td><td width=450><img src=/img/Show-Win32AppUI/Win32AppUI-Page3.png alt=3 width=450px height=850px></td></tr><tr><td><h3>Page3 - Implement</h3>The final page follows a step-by-step approach to creating the Win32 App.<br><br><b>Create Wrapper Scripts</b> creates an install.ps1 and uninstall.ps1 file in the package source folder.<br><br><b>Create Intunewin Package</b> uses the Win32 Content Prep Tool to build an .intunewin file in the Output Folder.<br><br><b>Create App Groups</b> creates three AAD groups for Required Install, Available Install and Uninstall. If the groups already exist they are re-used.<br><br><b>Create Win32 App</b> creates the Win32 App in Intune and uploads the .intunewin file. This step can take some time depending on the package size.<br><br><b>Configure Dependency / Configure Supercedence</b> modifies the Win32 App in Intune. These steps are skipped if they are set to None.<br><br><b>Configure Assignment</b> modifies the Win32 App in Intune to add the assignment groups created in the earlier step.</td><td width=450><img src=/img/Show-Win32AppUI/Win32AppUI-Page4.png alt=4 width=450px height=850px></td></tr></table><h1 id=troubleshooting>Troubleshooting<a hidden class=anchor aria-hidden=true href=#troubleshooting>#</a></h1><p>The tool creates a debug log on every run with detailed information and error messages. The default LogFolder is C:\Temp, but can be modified on Line 8 of Show-Win32AppUI.ps1.</p><p>The -WriteHost switch will also show the debug output in the console.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=p>.\</span><span class=nb>Show-Win32AppUI</span><span class=p>.</span><span class=py>ps1</span> <span class=n>-writehost</span>
</span></span></code></pre></div><p><img loading=lazy src=/img/Show-Win32AppUI/Win32AppUI-WriteHost.png alt=WriteHost></p><h1 id=options>Options<a hidden class=anchor aria-hidden=true href=#options>#</a></h1><p>The variables section in Show-Win32AppUI.ps1 allows default settings to be modified. The following section is at Line 50:</p><p><img loading=lazy src=/img/Show-Win32AppUI/Win32AppUI-Defaults.png alt=WriteHost></p><h1 id=detection-method>Detection Method<a hidden class=anchor aria-hidden=true href=#detection-method>#</a></h1><p>The Win32 app detection is hardcoded to use a file exists method. The <em>Install.ps1</em> script wrapper creates a &ldquo;.ps1.tag&rdquo; file under the %PROGRAMDATA% folder and <em>Uninstall.ps1</em> deletes it - a detection method <a href=https://oofhours.com/2020/05/18/two-for-one-updated-autopilot-branding-and-update-os-scripts/>first suggested by Michael Niehaus</a></p><h1 id=credits>Credits<a hidden class=anchor aria-hidden=true href=#credits>#</a></h1><ul><li><p>Show-Win32AppUI is a front-end to the excellent <a href=https://github.com/MSEndpointMgr/IntuneWin32App>IntuneWin32App module</a>. Full credit to the contributors of this project.</p></li><li><p>The <a href=https://github.com/AzureAD/MSAL.PS>MSAL.PS module</a> has simplified the transition from ADAL to MSAL authentication.</p></li><li><p><a href=https://learn-powershell.net/>Boe Prox</a> for PowerShell Runspace tips</p></li><li><p><a href=https://smsagent.blog/blog-posts/>SMSAgent</a> for PowerShell WPF tips</p></li></ul><p><br><br></p><blockquote><p>This article was originally posted on <a href=http://write-verbose.com>Write-Verbose.com</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://write-verbose.com/tags/intune/>Intune</a></li><li><a href=https://write-verbose.com/tags/msgraph/>MSGraph</a></li><li><a href=https://write-verbose.com/tags/wpf/>WPF</a></li></ul><nav class=paginav><a class=prev href=https://write-verbose.com/2023/03/19/AzureAppRegistration/><span class=title>« Prev</span><br><span>A custom Azure app with limited Microsoft Graph consent for PowerShell</span></a>
<a class=next href=https://write-verbose.com/2023/02/02/Firewallmde/><span class=title>Next »</span><br><span>Enable Defender Firewall event forwarding to MDE</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on twitter" href="https://twitter.com/intent/tweet/?text=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f&hashtags=Intune%2cMSGraph%2cWPF"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f&title=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end&summary=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end&source=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f&title=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on whatsapp" href="https://api.whatsapp.com/send?text=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end%20-%20https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Create Intune Win32Apps with a PowerShell GUI front-end on telegram" href="https://telegram.me/share/url?text=Create%20Intune%20Win32Apps%20with%20a%20PowerShell%20GUI%20front-end&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f03%2f18%2fShow-Win32AppUI%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://write-verbose.com/>Write-Verbose</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>