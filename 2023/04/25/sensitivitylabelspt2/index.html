<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Purview Information Protection Deep Dive Pt2 - Automatic Labelling | Write-Verbose</title><meta name=keywords content="m365,security,governance,MIP,Purview"><meta name=description content="Sensitivity Labels and Purview Information Protection Policies Part Two"><meta name=author content="GD"><link rel=canonical href=https://write-verbose.com/2023/04/25/sensitivitylabelspt2/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://write-verbose.com/fav/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://write-verbose.com/fav/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://write-verbose.com/fav/favicon-32x32.png><link rel=apple-touch-icon href=https://write-verbose.com/apple-touch-icon.png><link rel=mask-icon href=https://write-verbose.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/hybrid.min.css integrity="sha512-BoPJq6KvI1u+cpSqlC0hoQBjJNPcq1xpOncS9hMdGLMBoLJO7qGIZbK5YOk0DkIvn4EmKyZRpcwjLm4GygUX+g==" crossorigin=anonymous><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-141237050-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Purview Information Protection Deep Dive Pt2 - Automatic Labelling"><meta property="og:description" content="Sensitivity Labels and Purview Information Protection Policies Part Two"><meta property="og:type" content="article"><meta property="og:url" content="https://write-verbose.com/2023/04/25/sensitivitylabelspt2/"><meta property="og:image" content="https://write-verbose.com/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-25T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://write-verbose.com/papermod-cover.png"><meta name=twitter:title content="Purview Information Protection Deep Dive Pt2 - Automatic Labelling"><meta name=twitter:description content="Sensitivity Labels and Purview Information Protection Policies Part Two"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://write-verbose.com/posts/"},{"@type":"ListItem","position":2,"name":"Purview Information Protection Deep Dive Pt2 - Automatic Labelling","item":"https://write-verbose.com/2023/04/25/sensitivitylabelspt2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Purview Information Protection Deep Dive Pt2 - Automatic Labelling","name":"Purview Information Protection Deep Dive Pt2 - Automatic Labelling","description":"Sensitivity Labels and Purview Information Protection Policies Part Two","keywords":["m365","security","governance","MIP","Purview"],"articleBody":"Part two of a deep dive series on Purview Sensitivity Labels:\nPart 1 - Manual Labelling\nPart 2 - Automatic Labelling\nPart 3 - Recommendations and Limitations\nAutomatic Labelling Manual Labelling is often the introduction to Sensitivity Labels, but eventually you will want to look at automation. In particular, it will be needed to add coverage of data at rest. Manual labelling, even if mandatory, only applies when an existing file is re-saved.\nThe main blocker for many companies is that Automatic Labelling is not available with an E3 license. It requires either Microsoft 365 E5, or E3 plus Microsoft 365 E5 Compliance or Microsoft 365 E5 Information Protection and Governance.\nThere are two options for automatically applying Sensitivity Labels:\nClient-side auto-labelling for files and emails Service-side auto-labelling for SharePoint Online, Exchange Online and OneDrive Client-side Auto-labelling Auto-labelling for files and emails is a client option, configured per-label, that either automatically applies the label, or recommends it to the user based on pattern matching in the content.\nClient-side auto-labelling only occurs when an item is being created or edited, it doesn’t apply to data at rest or in-transit. The auto-label policy is based on matching one or more Sensitive Info Types or Trainable Classifiers. For example, if the content matches a passport number.\nService-side auto-labelling Service-side auto-labelling is a separate option in the Information Protection blade of the Purview Compliance Center. This option is not dependent on supported client apps or reliant on user adoption. Labels are applied by the back-end M365 services.\nCreate an Auto-labelling policy to apply one of the pre-defined labels to unlabelled data at rest in supported locations.\nThe policy wizard has pre-defined Templates for matching content based on well-known regulatory and enterprise requirements. For example, the UK Financial Template includes the Sensitive Info Types that match credit card numbers, debit card numbers and SWIFT bank codes in the scanned content.\nAlternatively, the Custom Template option creates a policy with bespoke pattern matching, as follows…\nFirst select one or more of the supported storage locations to apply the automatic labelling:\nExchange Online SharePoint Online OneDrive for Business SharePoint and OneDrive both support auto-labelling of data at rest. Exchange Online only supports auto-labelling of data in-transit.\nNext create rules containing include and exclude Conditions to identify items in-scope. A rule can contain multiple conditions and it can apply to all three storage locations, or be specific to a particular one.\nConditions available for SharePoint Online and OneDrive for Business:\nCondition Description Content is shared Inside or Outside the organisation Content Contains Sensitive Info Types and/or Trainable Classifiers Exchange Online has many additional Conditions:\nCondition Description Content is shared Inside or Outside the organisation Recipient Domain is List of email domains Recipient is Specific email addresses Sender IP Address Specific IPv4 address or a range Sender domain is List of email domains Sender is Specific email addresses Attachment file extension is List of file extensions Attachment is password protected Detects email attachments with password protection Attachment’s content could not be scannedAttachment’s content didn’t complete scanning Detects emails with attachments that can’t be scanned Header matches pattern Regex match on portion of email header Subject matches pattern Regex match on email subject Recipient address contains wordsRecipient address matches pattern List of words in recipient address or match to regex pattern Sender address matches wordsSender address matches pattern List of words in sender address or match to regex pattern Content Contains Sensitive Info Types and/or Trainable Classifiers The additional conditions are only available for Exchange when creating a per-location rule. Simulation mode is a mandatory step in creating an auto-labelling policy. Content discovery takes place and the administrator can review matched items to ensure rules are correct. The policy can then be turned-on for real.\nSensitive Information Types Sensitive information Types are search patterns for named data types. They are used to automatically classify content that matches the pattern, for example:\nUS / UK Passport number SWIFT code Japan Social Security Number Credit Card Number Azure AD client secret Sensitive Info Types can be used in Client-side and Service-side auto-labelling.\nThere is a long list of built-in Sensitive Information Types (SIT) provided by Microsoft. You can also create your own in the Data Classification blade of the Purview Compliance Center. Custom SITs are one of the following:\nPattern-based SIT When you create a pattern-based Sensitive Info Type, you can specify a Primary element and Supporting elements. The elements consist of the following options:\nRegular Expression Keyword list Keyword dictionary (longer list of keywords) Existing Sensitive Info type The Secondary Element can be a list of the above, grouped by Any, All or None. The Primary Element and Supporting Elements can be anywhere in the document or near each other within a specified number of characters.\nFingerprint-based SIT A Fingerprint-based Sensitive Info Type is created by uploading an example document. It works best with Forms and Templates.\nTrainable Classifiers This method of automatic-labelling is based on machine learning. A Classifier is trained to recognise a document through examples. The classifier must first be fed a selection of documents that are in-scope and out-of-scope of the required label. The administrator must confirm or reject the automatic classification to train the learning model. It can then be applied to a bulk repository such as a document library.\nMicrosoft provides many \u0026ldquo;ready-to-use\u0026rdquo; classifiers, including ones to detect profanity, threats and discrimination and even resumes (CVs). Creating a custom Trainable Classifier requires at least 50 sample documents. It can take up-to 2 weeks to scan your environment using these classifiers.\nTrainable Classifiers can be used in Client-side and Service-side auto-labelling. They can also be used to apply Retention Labels.\nExchange Mail Flow Rules Encryption can be applied using Labels in Exchange Mail Flow rules. This option may be an attractive alternative if you don’t have an E5 license that supports Automatic Label Policies. The Label and associated encryption is applied to messages in transit (not messages at rest in mailboxes).\nCreate a Rule as follows…\nIn the Exchange Admin Portal, select Mail Flow \u003e Rules \u003e Add a rule\nIn the drop-down list select the option to Apply Office 365 Message Encryption and rights protection to messages\nComplete the Rule Conditions and select Rights protect message with [SELECTED LABEL]\nSharePoint Default Sensitivity Label You can set a default Sensitivity Label for SharePoint content and it will apply to documents uploaded or re-saved in a Library. The setting can be applied at the Site Level (Settings \u003e Site Information) or the Library Level (Settings \u003e Library Settings). It requires Site Admin permissions.\nA manually-applied label will always win over a SPO Library default. The Library setting can override an auto-labelling policy or label policy default setting, if the Library setting is higher priority.\nA SharePoint default Label only applies to new document uploads. Existing files in the Library only receive the Label when they are re-saved.\nLabels with the following settings can’t be used as a SharePoint default label:\nA Label with encryption set to Let users assign permissions when they apply the label A Label set to In Word, PowerPoint and Excel, prompt users to specify permissions If a user manually removes encryption from a labelled document in a SharePoint Library, the encryption will be restored the next time it is accessed or downloaded.\nThe automatic Labelling process does not affect the Last Modified date of files.\nNOTE that an SPO Default Label is different to Label Policies that target SharePoint. Label Policies apply container settings such as external access.\nSharePoint Sensitivity column Don’t forget to update the All Documents view to show a column for Sensitivity\nIn a Library \u003e Add column \u003e Show or hide columns \u003e Select Sensitivity \u003e Apply Then click the All Documents drop-down and select Save view as, leave the default “All Documents” and click Save\nThe Library will then always show the Sensitivity Label alongside the File Name and Modified Date.\nProtecting Teams Meetings and Chat A Label can be applied to Teams meetings and Chat if the following are true:\nOrganization has a Teams Premium license (included in E5 but not E3) The Label is scoped to both Files and Emails The meeting owner is using M365 Apps for Enterprise or OWA on a Desktop computer (not supported on mobile apps) When encryption is turned-on, the following controls can be configured by the Label:\nWho can bypass the lobby Who can present, record Automatic recording Prevent copy of meeting chat Add a watermark during screen sharing and camera streams What is Azure Information Protection? Azure Information Protection (AIP) extends what is available in Purview Information Protection and also provides some of the services used by Purview Information Protection. In its original form AIP used separate Sensitivity Labels managed in the Azure Portal. Since 2019, AIP has been updated with a Unified Labelling Client that uses Purview Sensitivity Labels.\nThe following are some reasons to extend the Data Classification Framework with AIP:\nBulk labelling and protection of on-prem file shares and SharePoint libraries Bulk decryption for data recovery Apply labels directly from File Explorer or PowerShell Supports additional file types for classification and protection Supports Office 2003-2007 file formats Logging to the Windows event log To use AIP you will need to deploy the unified labelling client to Windows computers. You may see references in documentation to the AIP Classic Client. This is the older version of AIP that is now deprecated.\nIf the AIP client is installed, the built-in labelling interfaces in Office are disabled (e.g. the Ribbon Sensitivity button) and an Office add-in displays an information bar instead. It’s a supported scenario to use AIP for some features while still using the built-in labelling for Office. To achieve this, just disable the AIP Office add-ins (MSIP.WordAddin, MSIP.ExcelAddin, MSIP.PowerPointAddin, MSIP.OutlookAddin) using a Group policy / CSP setting.\nAIP Unified Labelling Scanner? The Scanner works by running jobs that crawl the specified data stores to label and protect the documents. This can be a one-off exercise to ensure wide coverage (then relying on native labelling options), or it could be a repeat scheduled process.\nThe Scanner runs as a service on a Windows Server (2016 or later for long path support) and also requires a SQL server backend. It requires an application registration in Azure AD, that provides a token for the service to authenticate with AIP. The scan jobs are configured in the AIP blade of Azure rather than on the Server.\nThe process of scanning large data stores can be time consuming, so the Scanner supports inclusion and exclusion by file type (file extension) to pre-filter the file list. It can also be clustered with multiple servers working in parallel. It uses the same built-in iFilters used by Windows Search to access document content and look for matches to automatic label patterns.\nThe Scanner can be run first in Discovery Mode to create a report of labels and protection that would be applied through automatic classification rules.\nAIP Supported file types for scanner inspection .doc, docx, .docm, .dot, .dotx, .xls, .xlt, .xlsx, .xlsm, .xlsb, .ppt, .pps, .pot, .pptx, .pdf, .txt, .xml, .csv This article was originally posted on Write-Verbose.com\n","wordCount":"1863","inLanguage":"en","datePublished":"2023-04-25T00:00:00Z","dateModified":"2023-04-25T00:00:00Z","author":{"@type":"Person","name":"GD"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://write-verbose.com/2023/04/25/sensitivitylabelspt2/"},"publisher":{"@type":"Organization","name":"Write-Verbose","logo":{"@type":"ImageObject","url":"https://write-verbose.com/fav/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://write-verbose.com/ accesskey=h title="Write-Verbose (Alt + H)">Write-Verbose</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://write-verbose.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://write-verbose.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://write-verbose.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://write-verbose.com/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://write-verbose.com/>Home</a>&nbsp;»&nbsp;<a href=https://write-verbose.com/posts/>Posts</a></div><h1 class=post-title>Purview Information Protection Deep Dive Pt2 - Automatic Labelling</h1><div class=post-description>Sensitivity Labels and Purview Information Protection Policies Part Two</div><div class=post-meta><span title='2023-04-25 00:00:00 +0000 UTC'>April 25, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;GD</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#automatic-labelling aria-label="Automatic Labelling">Automatic Labelling</a><ul><li><a href=#client-side-auto-labelling aria-label="Client-side Auto-labelling">Client-side Auto-labelling</a></li><li><a href=#service-side-auto-labelling aria-label="Service-side auto-labelling">Service-side auto-labelling</a></li></ul></li><li><a href=#sensitive-information-types aria-label="Sensitive Information Types">Sensitive Information Types</a><ul><li><a href=#pattern-based-sit aria-label="Pattern-based SIT">Pattern-based SIT</a></li><li><a href=#fingerprint-based-sit aria-label="Fingerprint-based SIT">Fingerprint-based SIT</a></li></ul></li><li><a href=#trainable-classifiers aria-label="Trainable Classifiers">Trainable Classifiers</a></li><li><a href=#exchange-mail-flow-rules aria-label="Exchange Mail Flow Rules">Exchange Mail Flow Rules</a></li><li><a href=#sharepoint-default-sensitivity-label aria-label="SharePoint Default Sensitivity Label">SharePoint Default Sensitivity Label</a></li><li><a href=#sharepoint-sensitivity-column aria-label="SharePoint Sensitivity column">SharePoint Sensitivity column</a></li><li><a href=#protecting-teams-meetings-and-chat aria-label="Protecting Teams Meetings and Chat">Protecting Teams Meetings and Chat</a></li><li><a href=#what-is-azure-information-protection aria-label="What is Azure Information Protection?">What is Azure Information Protection?</a><ul><li><a href=#aip-unified-labelling-scanner aria-label="AIP Unified Labelling Scanner?">AIP Unified Labelling Scanner?</a></li><li><a href=#aip-supported-file-types-for-scanner-inspection aria-label="AIP Supported file types for scanner inspection">AIP Supported file types for scanner inspection</a></li></ul></li></ul></div></details></div><div class=post-content><p>Part two of a deep dive series on Purview Sensitivity Labels:</p><p>Part 1 - <a href=/2023/04/24/sensitivitylabelspt1/>Manual Labelling</a><br>Part 2 - Automatic Labelling<br>Part 3 - <a href=/2023/04/26/sensitivitylabelspt2/>Recommendations and Limitations</a></p><h2 id=automatic-labelling>Automatic Labelling<a hidden class=anchor aria-hidden=true href=#automatic-labelling>#</a></h2><p>Manual Labelling is often the introduction to Sensitivity Labels, but eventually you will want to look at automation. In particular, it will be needed to add coverage of data at rest. Manual labelling, even if mandatory, only applies when an existing file is re-saved.</p><p>The main blocker for many companies is that Automatic Labelling is not available with an E3 license. It requires either Microsoft 365 E5, or E3 plus <em>Microsoft 365 E5 Compliance</em> or <em>Microsoft 365 E5 Information Protection and Governance</em>.</p><p>There are two options for automatically applying Sensitivity Labels:</p><ol><li><strong>Client-side auto-labelling</strong> for files and emails</li><li><strong>Service-side auto-labelling</strong> for SharePoint Online, Exchange Online and OneDrive</li></ol><h3 id=client-side-auto-labelling>Client-side Auto-labelling<a hidden class=anchor aria-hidden=true href=#client-side-auto-labelling>#</a></h3><p><em>Auto-labelling for files and emails</em> is a client option, configured per-label, that either automatically applies the label, or recommends it to the user based on pattern matching in the content.</p><p>Client-side auto-labelling only occurs when an item is being created or edited, it doesn&rsquo;t apply to data at rest or in-transit.
The auto-label policy is based on matching one or more <strong>Sensitive Info Types</strong> or <strong>Trainable Classifiers</strong>. For example, if the content matches a passport number.</p><p><img loading=lazy src=/img/UsingMIPLabels/Label-AutoLabellingFiles.png alt="Client Auto-Labelling"></p><h3 id=service-side-auto-labelling>Service-side auto-labelling<a hidden class=anchor aria-hidden=true href=#service-side-auto-labelling>#</a></h3><p><em>Service-side auto-labelling</em> is a separate option in the Information Protection blade of the Purview Compliance Center. This option is not dependent on supported client apps or reliant on user adoption. Labels are applied by the back-end M365 services.</p><p>Create an <strong>Auto-labelling policy</strong> to apply one of the pre-defined labels to unlabelled data at rest in supported locations.<br>The policy wizard has pre-defined <strong>Templates</strong> for matching content based on well-known regulatory and enterprise requirements. For example, the <em>UK Financial Template</em> includes the <em>Sensitive Info Types</em> that match credit card numbers, debit card numbers and SWIFT bank codes in the scanned content.</p><p>Alternatively, the <strong>Custom Template</strong> option creates a policy with bespoke pattern matching, as follows&mldr;</p><p>First select one or more of the supported storage locations to apply the automatic labelling:</p><ul><li>Exchange Online</li><li>SharePoint Online</li><li>OneDrive for Business</li></ul><p>SharePoint and OneDrive both support auto-labelling of data at rest. Exchange Online only supports auto-labelling of data in-transit.</p><p><img loading=lazy src=/img/UsingMIPLabels/Label-Auto1.png alt="Client Auto-Labelling"></p><p>Next create rules containing include and exclude <strong>Conditions</strong> to identify items in-scope. A rule can contain multiple conditions and it can apply to all three storage locations, or be specific to a particular one.</p><p><strong>Conditions available for SharePoint Online and OneDrive for Business</strong>:</p><table><thead><tr><th>Condition</th><th>Description</th></tr></thead><tbody><tr><td>Content is shared</td><td>Inside or Outside the organisation</td></tr><tr><td>Content Contains</td><td>Sensitive Info Types and/or Trainable Classifiers</td></tr></tbody></table><p><strong>Exchange Online has many additional Conditions:</strong></p><table><thead><tr><th>Condition</th><th>Description</th></tr></thead><tbody><tr><td>Content is shared</td><td>Inside or Outside the organisation</td></tr><tr><td>Recipient Domain is</td><td>List of email domains</td></tr><tr><td>Recipient is</td><td>Specific email addresses</td></tr><tr><td>Sender IP Address</td><td>Specific IPv4 address or a range</td></tr><tr><td>Sender domain is</td><td>List of email domains</td></tr><tr><td>Sender is</td><td>Specific email addresses</td></tr><tr><td>Attachment file extension is</td><td>List of file extensions</td></tr><tr><td>Attachment is password protected</td><td>Detects email attachments with password protection</td></tr><tr><td>Attachment&rsquo;s content could not be scanned<br>Attachment&rsquo;s content didn&rsquo;t complete scanning</td><td>Detects emails with attachments that can&rsquo;t be scanned</td></tr><tr><td>Header matches pattern</td><td>Regex match on portion of email header</td></tr><tr><td>Subject matches pattern</td><td>Regex match on email subject</td></tr><tr><td>Recipient address contains words<br>Recipient address matches pattern</td><td>List of words in recipient address or match to regex pattern</td></tr><tr><td>Sender address matches words<br>Sender address matches pattern</td><td>List of words in sender address or match to regex pattern</td></tr><tr><td>Content Contains</td><td>Sensitive Info Types and/or Trainable Classifiers</td></tr></tbody></table><br>The additional conditions are only available for Exchange when creating a per-location rule.<br><br><p><strong>Simulation mode</strong> is a mandatory step in creating an auto-labelling policy. Content discovery takes place and the administrator can review matched items to ensure rules are correct. The policy can then be turned-on for real.</p><h2 id=sensitive-information-types>Sensitive Information Types<a hidden class=anchor aria-hidden=true href=#sensitive-information-types>#</a></h2><p><em>Sensitive information Types</em> are search patterns for named data types. They are used to automatically classify content that matches the pattern, for example:</p><ul><li>US / UK Passport number</li><li>SWIFT code</li><li>Japan Social Security Number</li><li>Credit Card Number</li><li>Azure AD client secret</li></ul><p>Sensitive Info Types can be used in Client-side and Service-side auto-labelling.</p><p>There is a long list of <a href="https://learn.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide" target=_blank>built-in Sensitive Information Types (SIT) provided by Microsoft</a>. You can also create your own in the <a href="https://compliance.microsoft.com/dataclassificationclassifiers?viewid=sensitiveinfotypes" target=_blank>&lt;em>Data Classification&lt;/em> blade</a> of the Purview Compliance Center. Custom SITs are one of the following:</p><h3 id=pattern-based-sit>Pattern-based SIT<a hidden class=anchor aria-hidden=true href=#pattern-based-sit>#</a></h3><p>When you create a pattern-based Sensitive Info Type, you can specify a <strong>Primary element</strong> and <strong>Supporting elements</strong>. The elements consist of the following options:</p><ul><li>Regular Expression</li><li>Keyword list</li><li>Keyword dictionary (longer list of keywords)</li><li>Existing Sensitive Info type</li></ul><p>The Secondary Element can be a list of the above, grouped by <em>Any, All or None</em>. The Primary Element and Supporting Elements can be anywhere in the document or near each other within a specified number of characters.</p><h3 id=fingerprint-based-sit>Fingerprint-based SIT<a hidden class=anchor aria-hidden=true href=#fingerprint-based-sit>#</a></h3><p>A Fingerprint-based Sensitive Info Type is created by uploading an example document. It works best with Forms and Templates.</p><h2 id=trainable-classifiers>Trainable Classifiers<a hidden class=anchor aria-hidden=true href=#trainable-classifiers>#</a></h2><p>This method of automatic-labelling is based on machine learning. A Classifier is trained to recognise a document through examples. The classifier must first be fed a selection of documents that are in-scope and out-of-scope of the required label. The administrator must confirm or reject the automatic classification to train the learning model. It can then be applied to a bulk repository such as a document library.</p><p>Microsoft provides many <a href="https://learn.microsoft.com/en-us/microsoft-365/compliance/classifier-tc-definitions?view=o365-worldwide#trainable-classifiers-definitions" target=_blank>&amp;ldquo;ready-to-use&amp;rdquo; classifiers</a>, including ones to detect profanity, threats and discrimination and even resumes (CVs). Creating a custom Trainable Classifier requires at least 50 sample documents. It can take up-to 2 weeks to scan your environment using these classifiers.</p><p>Trainable Classifiers can be used in Client-side and Service-side auto-labelling. They can also be used to apply Retention Labels.</p><p><img loading=lazy src=/img/UsingMIPLabels/Label-Classifier.png alt="Trainable Classifiers"></p><h2 id=exchange-mail-flow-rules>Exchange Mail Flow Rules<a hidden class=anchor aria-hidden=true href=#exchange-mail-flow-rules>#</a></h2><p>Encryption can be applied using Labels in Exchange Mail Flow rules. This option may be an attractive alternative if you don&rsquo;t have an E5 license that supports Automatic Label Policies. The Label and associated encryption is applied to messages in transit (not messages at rest in mailboxes).</p><p>Create a Rule as follows&mldr;<br>In the <a href=https://admin.exchange.microsoft.com/ target=_blank>Exchange Admin Portal</a>, select Mail Flow > Rules > Add a rule</p><p>In the drop-down list select the option to <em>Apply Office 365 Message Encryption and rights protection to messages</em></p><p><img loading=lazy src=/img/UsingMIPLabels/Label-MailFlow1.png alt="Mail Flow Rule"></p><p>Complete the <em>Rule Conditions</em> and select <strong>Rights protect message with [SELECTED LABEL]</strong></p><h2 id=sharepoint-default-sensitivity-label>SharePoint Default Sensitivity Label<a hidden class=anchor aria-hidden=true href=#sharepoint-default-sensitivity-label>#</a></h2><p>You can set a default Sensitivity Label for SharePoint content and it will apply to documents uploaded or re-saved in a Library. The setting can be applied at the Site Level (Settings > Site Information) or the Library Level (Settings > Library Settings). It requires Site Admin permissions.</p><p><img loading=lazy src=/img/UsingMIPLabels/Label-SPLibrary.png alt="SPO Default"></p><p>A manually-applied label will always <em>win</em> over a SPO Library default. The Library setting can override an auto-labelling policy or label policy default setting, if the Library setting is higher priority.</p><p>A SharePoint default Label only applies to new document uploads. Existing files in the Library only receive the Label when they are re-saved.</p><p>Labels with the following settings can&rsquo;t be used as a SharePoint default label:</p><ul><li>A Label with encryption set to <em>Let users assign permissions when they apply the label</em></li><li>A Label set to <em>In Word, PowerPoint and Excel, prompt users to specify permissions</em></li></ul><p>If a user manually removes encryption from a labelled document in a SharePoint Library, the encryption will be restored the next time it is accessed or downloaded.</p><p>The automatic Labelling process does not affect the Last Modified date of files.</p><p><strong>NOTE</strong> that an SPO Default Label is different to Label Policies that target SharePoint. Label Policies apply container settings such as external access.</p><h2 id=sharepoint-sensitivity-column>SharePoint Sensitivity column<a hidden class=anchor aria-hidden=true href=#sharepoint-sensitivity-column>#</a></h2><p>Don&rsquo;t forget to update the <em>All Documents</em> view to show a column for Sensitivity</p><p>In a Library > Add column > Show or hide columns > Select Sensitivity > Apply
Then click the All Documents drop-down and select <em>Save view as</em>, leave the default &ldquo;All Documents&rdquo; and click Save</p><p>The Library will then always show the Sensitivity Label alongside the File Name and Modified Date.</p><h2 id=protecting-teams-meetings-and-chat>Protecting Teams Meetings and Chat<a hidden class=anchor aria-hidden=true href=#protecting-teams-meetings-and-chat>#</a></h2><p>A Label can be applied to Teams meetings and Chat if the following are true:</p><ul><li>Organization has a Teams Premium license (included in E5 but not E3)</li><li>The Label is scoped to both Files and Emails</li><li>The meeting owner is using M365 Apps for Enterprise or OWA on a Desktop computer (not supported on mobile apps)</li></ul><p>When encryption is turned-on, the following controls can be configured by the Label:</p><ul><li>Who can bypass the lobby</li><li>Who can present, record</li><li>Automatic recording</li><li>Prevent copy of meeting chat</li><li>Add a watermark during screen sharing and camera streams</li></ul><h2 id=what-is-azure-information-protection>What is Azure Information Protection?<a hidden class=anchor aria-hidden=true href=#what-is-azure-information-protection>#</a></h2><p><em>Azure Information Protection</em> (AIP) extends what is available in <em>Purview Information Protection</em> and also provides some of the services used by Purview Information Protection.
In its original form AIP used separate Sensitivity Labels managed in the Azure Portal. Since 2019, AIP has been updated with a <em>Unified Labelling Client</em> that uses Purview Sensitivity Labels.</p><p>The following are some reasons to extend the Data Classification Framework with AIP:</p><ul><li>Bulk labelling and protection of <strong>on-prem file shares and SharePoint libraries</strong></li><li>Bulk decryption for data recovery</li><li>Apply labels directly from File Explorer or PowerShell</li><li>Supports additional file types for classification and protection</li><li>Supports Office 2003-2007 file formats</li><li>Logging to the Windows event log</li></ul><p>To use AIP you will need to deploy the <a href="https://www.microsoft.com/download/details.aspx?id=53018" target=_blank>unified labelling client</a> to Windows computers. You may see references in documentation to the AIP Classic Client. This is the older version of AIP that is now deprecated.</p><p>If the AIP client is installed, the built-in labelling interfaces in Office are disabled (e.g. the Ribbon Sensitivity button) and an Office add-in displays an information bar instead. It&rsquo;s a supported scenario to use AIP for some features while still using the built-in labelling for Office. To achieve this, just disable the AIP Office add-ins (MSIP.WordAddin, MSIP.ExcelAddin, MSIP.PowerPointAddin, MSIP.OutlookAddin) using a Group policy / CSP setting.</p><h3 id=aip-unified-labelling-scanner>AIP Unified Labelling Scanner?<a hidden class=anchor aria-hidden=true href=#aip-unified-labelling-scanner>#</a></h3><p>The Scanner works by running jobs that crawl the specified data stores to label and protect the documents. This can be a one-off exercise to ensure wide coverage (then relying on native labelling options), or it could be a repeat scheduled process.</p><p>The Scanner runs as a service on a Windows Server (2016 or later for long path support) and also requires a SQL server backend. It requires an application registration in Azure AD, that provides a token for the service to authenticate with AIP. The scan jobs are configured in the AIP blade of Azure rather than on the Server.</p><p>The process of scanning large data stores can be time consuming, so the Scanner supports inclusion and exclusion by file type (file extension) to pre-filter the file list. It can also be clustered with multiple servers working in parallel. It uses the same built-in iFilters used by Windows Search to access document content and look for matches to automatic label patterns.</p><p>The Scanner can be run first in <em>Discovery Mode</em> to create a report of labels and protection that would be applied through automatic classification rules.</p><h3 id=aip-supported-file-types-for-scanner-inspection>AIP Supported file types for scanner inspection<a hidden class=anchor aria-hidden=true href=#aip-supported-file-types-for-scanner-inspection>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl> .doc, docx, .docm, .dot, .dotx, .xls, .xlt, .xlsx, .xlsm, .xlsb, .ppt, .pps, .pot, .pptx, .pdf, .txt, .xml, .csv
</span></span></code></pre></div><p><br><br></p><blockquote><p>This article was originally posted on <a href=http://write-verbose.com target=_blank>Write-Verbose.com</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://write-verbose.com/tags/m365/>m365</a></li><li><a href=https://write-verbose.com/tags/security/>security</a></li><li><a href=https://write-verbose.com/tags/governance/>governance</a></li><li><a href=https://write-verbose.com/tags/mip/>MIP</a></li><li><a href=https://write-verbose.com/tags/purview/>Purview</a></li></ul><nav class=paginav><a class=prev href=https://write-verbose.com/2023/04/26/sensitivitylabelspt2/><span class=title>« Prev</span><br><span>Purview Information Protection Deep Dive Pt3 - Recommendations and Limitations</span></a>
<a class=next href=https://write-verbose.com/2023/04/24/sensitivitylabelspt1/><span class=title>Next »</span><br><span>Purview Information Protection Deep Dive Pt1 - Manual Labelling</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on twitter" href="https://twitter.com/intent/tweet/?text=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f&hashtags=m365%2csecurity%2cgovernance%2cMIP%2cPurview"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f&title=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling&summary=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling&source=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f&title=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on whatsapp" href="https://api.whatsapp.com/send?text=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling%20-%20https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Purview Information Protection Deep Dive Pt2 - Automatic Labelling on telegram" href="https://telegram.me/share/url?text=Purview%20Information%20Protection%20Deep%20Dive%20Pt2%20-%20Automatic%20Labelling&url=https%3a%2f%2fwrite-verbose.com%2f2023%2f04%2f25%2fsensitivitylabelspt2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://write-verbose.com/>Write-Verbose</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>